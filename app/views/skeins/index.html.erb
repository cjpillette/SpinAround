<h1>Skeins</h1>
<%= link_to 'New Skein', new_skein_path if logged_in?(:site_admin, :spinner_seller)%>
  <% @skeins.each do |skein| %>
    <div class="card" style="width: 20rem;">
      <%= image_tag(skein.photo_main, class: 'card-img-top', width: '100%') %>
      <div class="card-block">
        <div class="row">
          <h4 class="card-title">
            <div class="skein-price">

            <%= form_tag charges_path, id: 'chargeForm' do %>
            
              <% if flash[:error].present? %>
                <div id="error_explanation">
                  <p><%= flash[:error] %></p>
                </div>
              <% end %>

            <label class="amount">
              <span>Amount: $ <%= skein.price %></span>
            </label> 
            <% end %>

            </div>

            <div class="shopping-cart">
              <%= fa_icon('cart-arrow-down') %>
            </div>

             <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
          data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
          data-description="<%= skein.spinned_by.profile.first_name %>'s skein"
          data-amount="<%= 100 * skein.price %> "
          data-locale="auto"></script>
          </h4>

        </div>
        <div class="row">
          <div class="skein-spinner">
            Spinned by: <%= skein.spinned_by.profile.first_name %>
          </div>
        </div>
        <div class="row">
          <div class="skein-availability">
            <%= skein.skein_available %> skeins available
          </div>
          <%= link_to fa_icon('ravelry'), yarn_path(skein.yarn) %>
        </div>

        <div class="row">
          <p class="card-text">Some text describing the product goes here and it sure is fabulous</p>
          <%= link_to fa_icon('info-circle'), skein %>
          <% if current_user == skein.spinned_by || logged_in?(:site_admin) %>
          <%= link_to fa_icon('pencil-square-o'), edit_skein_path(skein)  %>
          <%= link_to fa_icon('trash'), skein, method: :delete, data: { confirm: 'Are you sure?' }  %>
          <% end %>
        </div>
      </div>
    </div>
    <% end %>

<br>


